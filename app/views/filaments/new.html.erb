<!-- Page Header -->
<div class="text-center mb-5">
    <h3 class="display-5 fw-bold text-primary mb-3"><%= t('filaments.new.title') %></h3>
    <p class="lead text-muted"><%= t('filaments.new.subtitle') %></p>
</div>

<div class="row justify-content-center">
    <div class="col-lg-8">
        <%= form_with model: @filament, local: true, class: "needs-validation", novalidate: true do |form| %>
            <% if @filament.errors.any? %>
                <div class="alert alert-danger mb-4">
                    <h6 class="fw-bold mb-2">
                        <%= t('common.errors_prohibited', count: @filament.errors.count, errors: t('common.error_count', count: @filament.errors.count), model: t('models.filament').downcase) %>
                    </h6>
                    <ul class="mb-0 ps-3">
                        <% @filament.errors.full_messages.each do |message| %>
                            <li><%= message %></li>
                        <% end %>
                    </ul>
                </div>
            <% end %>

            <!-- Basic Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><%= t('filaments.sections.basic_info') %></h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <%= render Forms::FieldComponent.new(
                          form: form,
                          attribute: :name,
                          type: :text,
                          label: t('filaments.fields.name'),
                          required: true,
                          wrapper_class: "col-md-6",
                          options: { placeholder: t('filaments.fields.name_placeholder') }
                        ) %>
                        <%= render Forms::FieldComponent.new(
                          form: form,
                          attribute: :brand,
                          type: :text,
                          label: t('filaments.fields.brand'),
                          wrapper_class: "col-md-6",
                          options: { placeholder: t('filaments.fields.brand_placeholder') }
                        ) %>
                        <%= render Forms::SelectFieldComponent.new(
                          form: form,
                          attribute: :material_type,
                          choices: [
                            ['PLA', 'PLA'],
                            ['ABS', 'ABS'],
                            ['PETG', 'PETG'],
                            ['TPU', 'TPU'],
                            ['ASA', 'ASA'],
                            ['HIPS', 'HIPS'],
                            ['Nylon', 'Nylon'],
                            ['PC', 'PC'],
                            ['PVA', 'PVA'],
                            ['Wood', 'Wood'],
                            ['Metal', 'Metal'],
                            ['Carbon', 'Carbon']
                          ],
                          label: t('filaments.fields.material_type'),
                          prompt: t('filaments.fields.material_type_prompt'),
                          required: true,
                          wrapper_class: "col-md-6"
                        ) %>
                        <%= render Forms::SelectFieldComponent.new(
                          form: form,
                          attribute: :diameter,
                          choices: [['1.75mm', 1.75], ['2.85mm', 2.85], ['3.00mm', 3.0]],
                          label: t('filaments.fields.diameter'),
                          required: true,
                          wrapper_class: "col-md-6"
                        ) %>
                        <%= render Forms::FieldComponent.new(
                          form: form,
                          attribute: :color,
                          type: :text,
                          label: t('filaments.fields.color'),
                          wrapper_class: "col-md-6",
                          options: { placeholder: t('filaments.fields.color_placeholder') }
                        ) %>
                        <%= render Forms::FieldComponent.new(
                          form: form,
                          attribute: :finish,
                          type: :text,
                          label: t('filaments.fields.finish'),
                          wrapper_class: "col-md-6",
                          options: { placeholder: t('filaments.fields.finish_placeholder') }
                        ) %>
                    </div>
                </div>
            </div>

            <!-- Cost Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><%= t('filaments.sections.cost_info') %></h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <%= form.label :spool_weight, t('filaments.fields.spool_weight'), class: "form-label" %>
                            <div class="input-group">
                                <%= form.number_field :spool_weight, class: "form-control", step: 0.01, min: 0, placeholder: t('filaments.fields.spool_weight_placeholder') %>
                                <span class="input-group-text">g</span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <%= form.label :spool_price, t('filaments.fields.spool_price'), class: "form-label" %>
                            <div class="input-group">
                                <span class="input-group-text"><%= currency_symbol(current_user.default_currency) %></span>
                                <%= form.number_field :spool_price, class: "form-control", step: 0.01, min: 0, placeholder: t('filaments.fields.spool_price_placeholder') %>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <%= form.label :density, t('filaments.fields.density'), class: "form-label" %>
                            <div class="input-group">
                                <%= form.number_field :density, class: "form-control", step: 0.01, min: 0, placeholder: t('filaments.fields.density_placeholder') %>
                                <span class="input-group-text">g/cmÂ³</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Properties -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><%= t('filaments.sections.properties') %></h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="form-check">
                                <%= form.check_box :moisture_sensitive, class: "form-check-input" %>
                                <%= form.label :moisture_sensitive, t('filaments.fields.moisture_sensitive'), class: "form-check-label" %>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notes -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><%= t('filaments.fields.notes') %></h5>
                </div>
                <div class="card-body">
                    <%= render Forms::FieldComponent.new(
                      form: form,
                      attribute: :notes,
                      type: :textarea,
                      label: false,
                      wrapper: false,
                      options: { rows: 4, placeholder: t('filaments.fields.notes_placeholder') }
                    ) %>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="d-flex justify-content-center gap-3 mb-5">
                <%= form.submit t('filaments.buttons.add_filament'), class: "btn btn-primary px-4" %>
                <%= link_to t('actions.cancel'), filaments_path, class: "btn btn-outline-secondary px-4" %>
            </div>
        <% end %>
    </div>
</div>
