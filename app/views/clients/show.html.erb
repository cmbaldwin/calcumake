<!-- Page Header -->
<div class="d-flex justify-content-between align-items-start mb-4">
  <div>
    <h1 class="h2 text-primary mb-2"><%= @client.name %></h1>
    <% if @client.company_name.present? %>
      <p class="lead text-muted mb-0"><%= @client.company_name %></p>
    <% end %>
  </div>
  <div class="d-flex gap-2">
    <%= link_to t('actions.edit'), edit_client_path(@client), class: "btn btn-primary" %>
    <%= link_to t('actions.back'), clients_path, class: "btn btn-outline-secondary" %>
  </div>
</div>

<div class="row g-4">
  <!-- Contact Information -->
  <div class="col-lg-6">
    <div class="card h-100">
      <div class="card-header">
        <h5 class="mb-0"><%= t('clients.sections.contact_info') %></h5>
      </div>
      <div class="card-body">
        <div class="row g-3">
          <% if @client.email.present? %>
          <div class="col-12">
            <div class="spec-item">
              <label class="form-label text-muted mb-1"><%= t('clients.fields.email') %></label>
              <div class="fw-bold">
                <%= mail_to @client.email, @client.email %>
              </div>
            </div>
          </div>
          <% end %>
          <% if @client.phone.present? %>
          <div class="col-12">
            <div class="spec-item">
              <label class="form-label text-muted mb-1"><%= t('clients.fields.phone') %></label>
              <div class="fw-bold"><%= @client.phone %></div>
            </div>
          </div>
          <% end %>
          <% if @client.address.present? %>
          <div class="col-12">
            <div class="spec-item">
              <label class="form-label text-muted mb-1"><%= t('clients.fields.address') %></label>
              <div class="fw-bold"><%= simple_format(@client.address) %></div>
            </div>
          </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Additional Information -->
  <div class="col-lg-6">
    <div class="card h-100">
      <div class="card-header">
        <h5 class="mb-0"><%= t('clients.sections.additional_info') %></h5>
      </div>
      <div class="card-body">
        <div class="row g-3">
          <% if @client.tax_id.present? %>
          <div class="col-12">
            <div class="spec-item">
              <label class="form-label text-muted mb-1"><%= t('clients.fields.tax_id') %></label>
              <div class="fw-bold"><%= @client.tax_id %></div>
            </div>
          </div>
          <% end %>
          <div class="col-12">
            <div class="spec-item">
              <label class="form-label text-muted mb-1"><%= t('clients.show.member_since') %></label>
              <div class="fw-bold"><%= l(@client.created_at.to_date, format: :long) %></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Invoices -->
  <div class="col-12">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0"><%= t('clients.show.invoices') %></h5>
        <%= render Shared::BadgeComponent.new(text: @client.invoices.count.to_s, variant: "primary") %>
      </div>
      <div class="card-body">
        <% if @client.invoices.any? %>
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th><%= t('invoices.fields.invoice_number') %></th>
                <th><%= t('invoices.fields.print_pricing') %></th>
                <th><%= t('invoices.fields.invoice_date') %></th>
                <th><%= t('invoices.fields.status') %></th>
                <th><%= t('actions.actions') %></th>
              </tr>
            </thead>
            <tbody>
              <% @client.invoices.recent.limit(10).each do |invoice| %>
              <tr>
                <td><%= invoice.invoice_number %></td>
                <td><%= invoice.print_pricing.job_name %></td>
                <td><%= l(invoice.invoice_date, format: :short) %></td>
                <td>
                  <%= render Shared::BadgeComponent.new(
                    text: t("invoices.statuses.#{invoice.status}"),
                    variant: invoice.status == 'paid' ? 'success' : invoice.status == 'sent' ? 'warning' : 'secondary'
                  ) %>
                </td>
                <td>
                  <%= link_to t('actions.view'), print_pricing_invoice_path(invoice.print_pricing, invoice), class: "btn btn-sm btn-outline-primary" %>
                </td>
              </tr>
              <% end %>
            </tbody>
          </table>
        </div>
        <% else %>
        <div class="text-center py-4">
          <p class="text-muted mb-0"><%= t('clients.show.no_invoices') %></p>
        </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Print Pricings -->
  <div class="col-12">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0"><%= t('clients.show.print_pricings') %></h5>
        <%= render Shared::BadgeComponent.new(text: @client.print_pricings.count.to_s, variant: "primary") %>
      </div>
      <div class="card-body">
        <% if @client.print_pricings.any? %>
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th><%= t('print_pricing.job_name') %></th>
                <th><%= t('print_pricing.final_price') %></th>
                <th><%= t('print_pricing.times_printed') %></th>
                <th><%= t('actions.actions') %></th>
              </tr>
            </thead>
            <tbody>
              <% @client.print_pricings.order(created_at: :desc).limit(10).each do |pricing| %>
              <tr>
                <td><%= pricing.job_name %></td>
                <td><%= number_to_currency(pricing.final_price, unit: currency_symbol(pricing.default_currency)) %></td>
                <td><%= pricing.times_printed %></td>
                <td>
                  <%= link_to t('actions.view'), pricing, class: "btn btn-sm btn-outline-primary" %>
                </td>
              </tr>
              <% end %>
            </tbody>
          </table>
        </div>
        <% else %>
        <div class="text-center py-4">
          <p class="text-muted mb-0"><%= t('clients.show.no_print_pricings') %></p>
        </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Notes -->
  <% if @client.notes.present? %>
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><%= t('clients.fields.notes') %></h5>
      </div>
      <div class="card-body">
        <p class="mb-0"><%= simple_format(@client.notes) %></p>
      </div>
    </div>
  </div>
  <% end %>
</div>

<!-- Actions -->
<div class="d-flex justify-content-center gap-3 mt-5 pt-4 border-top">
  <%= link_to t('actions.edit'), edit_client_path(@client), class: "btn btn-primary" %>
  <%= link_to t('actions.delete'),
      @client,
      method: :delete,
      confirm: t('clients.confirm_delete', name: @client.name),
      class: "btn btn-outline-danger",
      data: { turbo_method: :delete, turbo_confirm: t('clients.confirm_delete', name: @client.name) } %>
  <%= link_to t('actions.back'), clients_path, class: "btn btn-outline-secondary" %>
</div>
