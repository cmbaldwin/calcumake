<%# Success response for client creation from modal %>
<%# Update the client select dropdown with new client %>
<%= turbo_stream.update "client_select_frame" do %>
  <label for="invoice_client_id" class="form-label"><%= t("invoices.fields.select_client") %></label>
  <select name="invoice[client_id]" id="invoice_client_id" class="form-select">
    <option value=""><%= t("invoices.fields.no_client_selected") %></option>
    <% current_user.clients.order(:name).each do |client| %>
      <option value="<%= client.id %>" <%= 'selected' if client.id == @client.id %>><%= client.display_name %></option>
    <% end %>
  </select>
<% end %>

<%# Clear modal content %>
<%= turbo_stream.update "modal_content", "" %>

<%# Close modal %>
<%= turbo_stream.append "modal" do %>
  <template>
    <script>
      const modalElement = document.getElementById('modal');
      const modalInstance = bootstrap.Modal.getInstance(modalElement);
      if (modalInstance) {
        modalInstance.hide();
      }
    </script>
  </template>
<% end %>

<%# Show success notification %>
<%= turbo_stream.prepend "flash" do %>
  <%= render "layouts/flash_message", type: :notice, message: flash.now[:notice] %>
<% end %>
